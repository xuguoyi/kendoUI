<!DOCTYPE html>
<html id="html">

<head>
  <title>menu</title>
  <meta charset="utf-8">
  <link href="../../styles/all.css" rel="stylesheet">
</head>

<body>
  <!-- <header class="k-content hd"> -->
    
    <div class="menu">
      <ul id="horizontalMenu">
        <div class="logo">
          <h4>原材料控制系统</h4>
          <h4>(MCS)</h4>
        </div>
        <li>
          Demo
          <ul>
            <li url="./form.html">表单</li>
            <li url="./frozen.html">Frozen and Editable</li>
            <li>Knitwear</li>
            <li>Shirts</li>
            <li>Belts</li>
            <li>Socks</li>
            <li>Fan Zone</li>
          </ul>
        </li>
        <li>
          Ladies
          <ul>
            <li>Jackets and Coats</li>
            <li>Jeans</li>
            <li>Knitwear</li>
            <li>Shirts</li>
            <li>Belts</li>
            <li>Socks</li>
            <li>Fan Zone</li>
          </ul>
        </li>
        <li>
          Kids
          <ul>
            <li>Jackets and Coats</li>
            <li>Jeans</li>
            <li>Knitwear</li>
            <li>Shirts</li>
            <li>Belts</li>
            <li>Socks</li>
            <li>Fan Zone</li>
          </ul>
        </li>
        <li>Sports</li>
        <li>Brands</li>
        <li url="./accessories.html">Accessories</li>
        <li url="./promotions.html">Promotions</li>
        <div id="toolbar"></div>
      </ul>
    </div>
    <!-- <div class="links">
      
    </div> -->
  <!-- </header> -->
  <div id="tabstrip"></div>

  <script type="text/javascript" src="../../js/require.js" data-main="../../js/main.js"></script>
  <script>
    function requireReady() {
      function includeLinkStyle(url) {
        var link = document.createElement("link");
        link.rel = "stylesheet";
        link.type = "text/css";
        link.href = url;
        document.getElementsByTagName("html")[0].appendChild(link);
      }
        
      includeLinkStyle("../../styles/kendo.black.min.css");
      $("#horizontalMenu").kendoMenu({
        scrollable: true
      });

      $("#toolbar").kendoToolBar({
        items: [
          {
              type: "splitButton",
              id: "button1",
              text: "Admin",
              menuButtons: [
                  { text: "Action 1", id: "action1" },
                  { text: "Action 2", id: "action2" },
                  { text: "Action 3", id: "action3" }
              ]
          },
          {
              type: "button",
              id: "button2",
              text: "消息",
          },
          {
              type: "button",
              id: "button3",
              text: "Themes",
          },
          {
              type: "button",
              id: "button4",
              text: "退出",
          }
        ],
      });

      $('#badge-overlay').kendoBadge({
        color: 'primary',
        shape: 'rectangle'
      });

      $('#badge-inbox').kendoBadge({
        color: 'info',
        shape: 'rounded'
      });


      var tabstrip = $("#tabstrip").kendoTabStrip({
        // animation: { open: { effects: "fadeIn" } },
        dataTextField: "text",
        dataContentUrlField: "ContentUrl",
        dataSource: [
          {
            text: "首页",
            ContentUrl: "./app.html"
          }
        ]
      }).data('kendoTabStrip')

      var tabToActivate = $("#tabstrip li:first")
      tabstrip.activateTab(tabToActivate)

      var configureCloseTab = function () {
        var tabsElements = $('#tabstrip li[role="tab"]:gt(0)');
        tabsElements.append('<span data-type="remove" class="k-link"><span class="k-icon k-i-x"></span></span>');
      };

      tabstrip.tabGroup.on("click", "[data-type='remove']", function (e) {
        e.preventDefault();
        e.stopPropagation();
        var item = $(e.target).closest(".k-item");
        tabstrip.remove(item.index());
        console.log(tabstrip, 'rm')
        if (tabstrip.items().length > 0 && item.hasClass('k-state-active')) {
          tabstrip.select(0);
        }
      });
      configureCloseTab()

      $("#horizontalMenu li").on("click", function () {
        let text = $(this).text()
        let url = $(this).attr('url')
        console.log(tabstrip._contentUrls, 'add')
        if (url && !tabstrip._contentUrls.includes(url)) {
          tabstrip.append(
            [{
              text: text,
              contentUrl: url
            }]
          )
          var tabsElements = $('#tabstrip li[role="tab"]:last-child');
          tabsElements.append('<span data-type="remove" class="k-link"><span class="k-icon k-i-x"></span></span>');
          tabstrip.activateTab(tabsElements)
          contAddHeight()
        }else {
          let n = tabstrip._contentUrls.indexOf(url)
          tabstrip.select(n)
        }
      })
      // 计算tab内高度
      function contAddHeight() {
        $('#tabstrip>.k-content').addClass("selected")
      }
      contAddHeight()
    };
  </script>

  <style>
    .k-menu-scroll-wrapper.horizontal li.k-item.k-last {
      border-right-width: 0;
    }
  </style>


</body>

</html>